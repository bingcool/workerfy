<?php
namespace Workerfy\Tests\Reboot;

class Worker extends \Workerfy\AbstractProcess {

    public function run() {

        // 模拟处理业务
        sleep(1);
        var_dump("子进程 开始 reboot start");
        go(function () {
            sleep(3);
            var_dump("children coroutine");
            go(function () {
                sleep(6);
                var_dump('children coroutine children coroutine');
            });
        });
        $this->reboot(); //可以观察到子进程pid在变化

    }

    public function onShutDown()
    {
        parent::onShutDown(); // TODO: Change the autogenerated stub
        var_dump("shutdown--");
    }

//    public function __destruct()
//    {
//        var_dump("destruct");
//    }
}